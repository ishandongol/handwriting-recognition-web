(this["webpackJsonphandwriting-recognition-web"]=this["webpackJsonphandwriting-recognition-web"]||[]).push([[0],{22:function(e,t,r){},43:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r.n(n),u=r(17),o=r.n(u),a=(r(22),r(3)),i=r(5),l=r(4),s=r(1),d=["width"],b=Object(n.forwardRef)((function(e,t){var r=e.width,n=Object(i.a)(e,d),c=r?r/2:0,u='url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="%23000000" opacity="0.3" height="'.concat(r,'" viewBox="0 0 ').concat(r," ").concat(r,'" width="').concat(r,'"><circle cx="').concat(c,'" cy="').concat(c,'" r="').concat(c,'" fill="%23000000" /></svg>\') ').concat(c," ").concat(c,", auto");return Object(s.jsx)("canvas",Object(a.a)(Object(a.a)({},n),{},{style:Object(a.a)(Object(a.a)({},n.style),{},{cursor:u}),ref:t}))})),h=function(e){var t=e.handlePredict,r=e.handleClear,n=e.className;return Object(s.jsx)("div",{className:"".concat(n," bottom-0"),children:Object(s.jsxs)("div",{className:"py-3",children:[Object(s.jsx)("a",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 text-center rounded-full md:block",onClick:function(e){e.preventDefault(),t()},href:"/",children:"Predict"}),Object(s.jsx)("a",{href:"/",className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 text-center my-4 rounded-full md:block ml-4 md:ml-0",onClick:function(e){e.preventDefault(),r()},children:"Clear"})]})})},f=r(8),v=r.n(f),j=["canvas","isReady"],O=["init","clear"],g=function(){var e=function(){var e=Object(n.useRef)(),t=Object(n.useState)(!1),r=Object(l.a)(t,2),c=r[0],u=r[1],o=Object(n.useState)(!0),a=Object(l.a)(o,2),i=a[0],s=a[1],d=Object(n.useState)(!1),b=Object(l.a)(d,2),h=b[0],f=b[1],v=Object(n.useState)(!1),j=Object(l.a)(v,2),O=j[0],g=j[1],m=Object(n.useState)("#000000"),p=Object(l.a)(m,2),w=p[0],C=p[1],k=Object(n.useState)(10),E=Object(l.a)(k,2),x=E[0],L=E[1],R=Object(n.useRef)(!1),y=Object(n.useRef)(100),T=Object(n.useRef)(10),S=Object(n.useRef)("#000000"),W=Object(n.useRef)(10),N=Object(n.useRef)(0),P=Object(n.useRef)(0),F=Object(n.useRef)(0),X=Object(n.useRef)(!1),M=Object(n.useRef)(!0),Y=Object(n.useRef)(!0),D=Object(n.useRef)(!1),J=Object(n.useRef)(),B=Object(n.useCallback)((function(e){if(console.log("drawing"),J&&J.current)if(J.current.beginPath(),J.current.moveTo(N.current,P.current),e instanceof TouchEvent?J.current.lineTo(e.touches[0].clientX,e.touches[0].clientY):J.current.lineTo(e.offsetX,e.offsetY),J.current.stroke(),e instanceof TouchEvent){var t=[e.touches[0].clientX,e.touches[0].clientY];N.current=t[0],P.current=t[1]}else{var r=[e.offsetX,e.offsetY];N.current=r[0],P.current=r[1]}}),[]),z=Object(n.useCallback)((function(e,t){X.current=!0;var r=[e,t];N.current=r[0],P.current=r[1]}),[]),A=Object(n.useCallback)((function(e){X.current=!0,z(e.offsetX,e.offsetY)}),[z]),H=Object(n.useCallback)((function(e){X.current=!0,z(e.touches[0].clientX,e.touches[0].clientY)}),[z]),I=Object(n.useCallback)((function(){J&&J.current&&((J.current.lineWidth>90||J.current.lineWidth<10)&&(M.current=!M.current),M.current?J.current.lineWidth++:J.current.lineWidth--,L(J.current.lineWidth))}),[]),q=Object(n.useCallback)((function(e){X.current&&J.current&&(Y.current||D.current?(J.current.strokeStyle=S.current,C(S.current),R.current&&!D.current?I():J.current.lineWidth=W.current,D.current?J.current.globalCompositeOperation="destination-out":J.current.globalCompositeOperation="source-over"):(C("hsl(".concat(F.current,",").concat(y.current,"%,").concat(T.current,"%)")),J.current.strokeStyle="hsl(".concat(F.current,",").concat(y.current,"%,").concat(T.current,"%)"),J.current.globalCompositeOperation="source-over",F.current++,F.current>=360&&(F.current=0),R.current?I():J.current.lineWidth=W.current),B(e))}),[B,I]),G=Object(n.useCallback)((function(){X.current=!1}),[]),U=Object(n.useCallback)((function(){e&&e.current&&(e.current.width=window.innerWidth,e.current.height=window.innerHeight)}),[]),K=Object(n.useCallback)((function(){var t;J.current=null===e||void 0===e||null===(t=e.current)||void 0===t?void 0:t.getContext("2d"),e&&e.current&&J&&J.current&&!c&&(console.log("create"),e.current.addEventListener("mousedown",A,!1),e.current.addEventListener("mousemove",q,!1),e.current.addEventListener("mouseup",G,!1),e.current.addEventListener("mouseout",G,!1),e.current.addEventListener("touchstart",H,!1),e.current.addEventListener("touchend",G,!1),e.current.addEventListener("touchcancel",G,!1),e.current.addEventListener("touchmove",q,!1),window.addEventListener("resize",U,!1),U(),J.current.strokeStyle="#000",J.current.lineJoin="round",J.current.lineCap="round",J.current.lineWidth=10,u(!0))}),[q,A,G,H,c,U]),Q=Object(n.useCallback)((function(){var t,r,n,c,o,a,i,l;console.log("clear"),null===(t=e.current)||void 0===t||t.removeEventListener("mousedown",A,!1),null===(r=e.current)||void 0===r||r.removeEventListener("mousemove",q,!1),null===(n=e.current)||void 0===n||n.removeEventListener("mouseup",G,!1),null===(c=e.current)||void 0===c||c.removeEventListener("mouseout",G,!1),null===(o=e.current)||void 0===o||o.removeEventListener("touchstart",H,!1),null===(a=e.current)||void 0===a||a.removeEventListener("touchend",G,!1),null===(i=e.current)||void 0===i||i.removeEventListener("touchcancel",G,!1),null===(l=e.current)||void 0===l||l.removeEventListener("touchmove",q,!1),window.removeEventListener("resize",U,!1),u(!1)}),[q,A,G,H,U]),V=Object(n.useCallback)((function(){s(!0),D.current=!1,g(!1),Y.current=!0}),[]),Z=Object(n.useCallback)((function(){s(!1),D.current=!1,g(!1),Y.current=!1}),[]),$=Object(n.useCallback)((function(){J&&J.current&&e&&e.current&&J.current.clearRect(0,0,e.current.width,e.current.height)}),[]);return[{canvas:e,isReady:c,currentWidth:x,currentColor:w,isRegularMode:i,isAutoWidth:h,isEraser:O},{init:K,clear:Q,handleRegularMode:V,handleSpecialMode:Z,handleColor:function(e){C(e.currentTarget.value),S.current=e.currentTarget.value},handleWidth:function(e){L(e.currentTarget.value),W.current=e.currentTarget.value},handleClear:$,handleEraserMode:function(e){R.current=!1,f(!1),s(!0),D.current=!0,g(!0)},setAutoWidth:function(e){var t,r;R.current=e.currentTarget.checked,f(e.currentTarget.checked),e.currentTarget.checked?L(null!==(t=null===J||void 0===J||null===(r=J.current)||void 0===r?void 0:r.lineWidth)&&void 0!==t?t:W.current):L(W.current)},setCurrentSaturation:function(e){C("hsl(".concat(F.current,",").concat(e.currentTarget.value,"%,").concat(T.current,"%)")),y.current=e.currentTarget.value},setCurrentLightness:function(e){C("hsl(".concat(F.current,",").concat(y.current,"%,").concat(e.currentTarget.value,"%)")),T.current=e.currentTarget.value}}]}(),t=Object(l.a)(e,2),r=t[0],c=r.canvas,u=r.isReady,o=Object(i.a)(r,j),d=t[1],f=d.init,g=d.clear,m=Object(i.a)(d,O),p=Object(n.useState)({prediction:"",probability:0,showPrediction:!1}),w=Object(l.a)(p,2),C=w[0],k=w[1],E=Object(n.useCallback)((function(){if(c&&c.current){var e="",t=new XMLHttpRequest;t.open("GET",c.current.toDataURL("image/jpg;base64;",.5)),t.responseType="blob",t.onload=function(){e=t.response,console.log(e);var r=new FormData;r.append("image",e),v.a.post("/upload",r).then((function(e){e&&v.a.get("/predict").then((function(e){return k({prediction:e.data.prediction,probability:e.data.probability,showPrediction:!0})})).catch((function(){alert("Failed to predict")}))})).catch((function(){alert("Failed to upload image")}))},t.send()}}),[c]),x=Object(a.a)(Object(a.a)(Object(a.a)({},o),m),{},{handlePredict:E});return Object(n.useEffect)((function(){u||f()}),[u,f]),Object(n.useEffect)((function(){return g}),[g]),Object(s.jsxs)(s.Fragment,{children:[C.showPrediction&&Object(s.jsx)("div",{className:"absolute",children:JSON.stringify(C)}),Object(s.jsx)(h,Object(a.a)(Object(a.a)({},x),{},{className:"w-full p-4 absolute bg-white"})),Object(s.jsx)(b,{width:o.currentWidth,ref:c,className:"h-screen w-screen border"})]})};var m=function(){return Object(s.jsx)(g,{})},p=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,44)).then((function(t){var r=t.getCLS,n=t.getFID,c=t.getFCP,u=t.getLCP,o=t.getTTFB;r(e),n(e),c(e),u(e),o(e)}))};o.a.render(Object(s.jsx)(c.a.StrictMode,{children:Object(s.jsx)(m,{})}),document.getElementById("root")),p()}},[[43,1,2]]]);
//# sourceMappingURL=main.731fe230.chunk.js.map